(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{38:function(e,t,s){"use strict";s.r(t),s.d(t,"ArchivedChatsController",(function(){return r}));var i=s(0),a=s(1);function n(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const r=new class{constructor(){n(this,"chatElements",new Map),n(this,"onBack",e=>{this.chatElements.clear(),this.container.hidden=!0;const t=e.currentTarget;t.removeEventListener("click",this.onBack),t.hidden=!0}),n(this,"onDialogsUpdate",e=>{const{dialogs:t,folderId:s}=e.detail;1===s&&this.renderChats(t)})}show(){this.container=Object(i.a)(".archived_chats_sidebar"),this.container.hidden=!1,this.container.innerHTML='\n      <div class="sidebar_header">\n        <div class="sidebar_header_title">Archived chats</div>\n      </div>\n      <div class="archived_chats_list"></div>\n    ',this.scrollContainer=Object(i.a)(".archived_chats_list",this.container),this.loader=Object(i.i)(this.scrollContainer);const e=Object(i.a)(".chats_header_back_button");if(e.addEventListener("click",this.onBack),e.hidden=!1,a.a.emitter.on("dialogsUpdate",this.onDialogsUpdate),a.a.archivedDialogs){this.renderChats(a.a.archivedDialogs);const e=a.a.archivedDialogs.slice(-1)[0];e.pinned||this.saveOffset(e)}this.loadMore()}loadMore(){this.loading=!0,a.a.loadArchivedDialogs(this.offset).then(e=>{e.length?(this.renderChats(e),this.saveOffset(e.slice(-1)[0])):this.noMore=!0}).finally(()=>{this.loading=!1})}saveOffset(e){const t=a.a.messages.get(e.top_message);this.offset={id:e.top_message,peer:e.peer,date:t.date}}renderChats(e){this.loader.remove();const t=document.createDocumentFragment();for(const s of e){const e=a.a.getPeerId(s.peer),i=ChatsController.chatElements.get(e)||ChatsController.buildChatPreviewElement(s);t.append(i)}this.scrollContainer.append(t)}};window.ArchivedChatsController=r}}]);