(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{43:function(e,t,n){"use strict";n.r(t),n.d(t,"ArchivedChatsController",(function(){return r}));var i=n(0),s=n(1);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const r=new class{constructor(){a(this,"chatElements",new Map),a(this,"onBack",e=>{this.chatElements.clear(),this.container.hidden=!0;const t=e.currentTarget;t.removeEventListener("click",this.onBack),t.hidden=!0}),a(this,"onDialogOrderUpdate",e=>{const{dialog:t,index:n,folderId:i}=e.detail;if(1!==i)return;const a=s.a.getPeerId(t.peer);let r=this.chatElements.get(a);r?(r.classList.toggle("chats_item-pinned",!!t.pinned),ChatsController.renderChatPreviewContent(r,t)):r=ChatsController.buildChatPreviewElement(t);const o=this.scrollContainer,c=o.children[n];c?c.before(r):o.appendChild(r)})}show(){this.container=Object(i.a)(".archived_chats_sidebar"),this.container.hidden=!1,this.container.innerHTML='\n      <div class="sidebar_header">\n        <div class="sidebar_header_title">Archived chats</div>\n      </div>\n      <div class="archived_chats_list"></div>\n    ',this.scrollContainer=Object(i.a)(".archived_chats_list",this.container),this.loader=Object(i.i)(this.scrollContainer);const e=Object(i.a)(".chats_header_back_button");if(e.addEventListener("click",this.onBack),e.hidden=!1,s.a.emitter.on("onDialogOrderUpdate",this.onDialogOrderUpdate),s.a.archivedDialogs.length){this.renderChats(s.a.archivedDialogs);const e=s.a.archivedDialogs.slice(-1)[0];e.pinned||this.saveOffset(e)}this.loadMore()}loadMore(){this.loading=!0,s.a.loadArchivedDialogs(this.offset).then(e=>{e.length?(this.renderChats(e),this.saveOffset(e.slice(-1)[0])):this.noMore=!0}).finally(()=>{this.loading=!1})}saveOffset(e){const t=s.a.messages.get(e.top_message);this.offset={id:e.top_message,peer:e.peer,date:t.date}}renderChats(e){this.loader.remove();const t=document.createDocumentFragment();for(const n of e){const e=s.a.getPeerId(n.peer),i=ChatsController.chatElements.get(e)||ChatsController.buildChatPreviewElement(n);t.append(i)}this.scrollContainer.append(t)}};window.ArchivedChatsController=r}}]);