(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{43:function(e,t,n){"use strict";n.r(t),n.d(t,"ArchivedChatsController",(function(){return s}));var i=n(0),r=n(1);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const s=new class{constructor(){a(this,"onBack",e=>{this.container.hidden=!0;const t=e.currentTarget;t.removeEventListener("click",this.onBack),t.hidden=!0}),a(this,"onDialogOrderUpdate",e=>{const{dialog:t,index:n,folderId:i}=e.detail;if(1!==i)return;const a=r.a.getPeerId(t.peer);let s=ChatsController.chatElements.get(a);s?(s.remove(),ChatsController.renderChatPreviewContent(s,t)):s=ChatsController.buildChatPreviewElement(t);const o=this.scrollContainer,d=o.children[n];d?d.before(s):o.appendChild(s)})}show(){this.container=Object(i.a)(".archived_chats_sidebar"),this.container.hidden=!1,this.container.innerHTML='\n      <div class="sidebar_header">\n        <div class="sidebar_header_title">Archived chats</div>\n      </div>\n      <div class="archived_chats_list"></div>\n    ',this.scrollContainer=Object(i.a)(".archived_chats_list",this.container),this.loader=Object(i.i)(this.scrollContainer);const e=Object(i.a)(".chats_header_back_button");if(e.addEventListener("click",this.onBack),e.hidden=!1,r.a.emitter.on("dialogOrderUpdate",this.onDialogOrderUpdate),r.a.archivedDialogs.length){this.renderChats(r.a.archivedDialogs);const e=r.a.archivedDialogs.slice(-1)[0];e.pinned||this.saveOffset(e)}this.loadMore()}loadMore(){this.loading=!0,r.a.loadArchivedDialogs(this.offset).then(e=>{e.length?(this.renderChats(e),this.saveOffset(e.slice(-1)[0])):this.noMore=!0}).finally(()=>{this.loading=!1})}saveOffset(e){const t=r.a.messages.get(e.top_message);this.offset={id:e.top_message,peer:e.peer,date:t.date}}renderChats(e){this.loader.remove();const t=document.createDocumentFragment();for(const n of e){const e=r.a.getPeerId(n.peer),i=ChatsController.chatElements.get(e)||ChatsController.buildChatPreviewElement(n);t.append(i)}this.scrollContainer.append(t)}};window.ArchivedChatsController=s}}]);